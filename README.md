# DICE Deployment IDE Plugin

Repo with Eclipse plugin that eases communication with DICE Deployment
Service.


## Maintainer info

Maintaining this repo is a bit tricky (we have a long-living gh-pages branch
that serves as a eclipse update site), so make sure you read next few
paragraphs carefully.

Master branch contains:

 1. sources of our plugins (`bundles/*`),
 2. features that wraps plugin (`features/*`) and
 3. release management files under `releng`.


### Setting up development environment

First, make sure you have eclipse installed and that plug-in development
plugins are installed (a bit of inception here;). Now simply start eclipse and
import projects from this repo. In order to make projects a bit easier to
navigate, switch project explorer view to hierarchical mode.


### Testing plugin

While having eclipse running, open `plugin.xml` file in
`bundles/org.dice.deployments.ui`. On the right side of the *Overview* tab
should be a button and a link named *Launch an Eclipse application* that will
start new eclipse instance with our plugins loaded.


### Generating update site

Update site is generated by maven. But before trying to do anything, we will
checkout `gh-pages` branch into a separate folder using `git worktree`
command. Exact command for this is

    git worktree add gh-pages gh-pages

This command will create new folder `gh-pages`. If we move inside this folder,
we will be automatically working on `gh-pages` branch. Note that this step
only needs to be taken first time we setup the local repo folder. For all
other updates, we will reuse existing work tree.

To generate update site contents and update version numbers, run
`./prepare-release.sh` script. Example invocation that will create release
0.3.1 would look like this:

    ./prepare-release.sh 0.3.1 gh-pages/updates

All that we need to do now is to commit the changes to the main and gh-pages
branch and update site is ready to be added to eclipse. Main address that
should be used for this repo by users is
`http://dice-project.github.io/DICE-Deployment-IDE-Plugin/updates/VERSION`,
which contains requested version of the plugin. This update site has orbit
update site already included, so there is no manual user intervention needed
when installing the plugin.

DICE IDE developers should use bare bones update sites available at
`http://dice-project.github.io/DICE-Deployment-IDE-Plugin/updates/VERSION/ide`.
This update site contains only features that are meant to be used when plugin
is integrated into DICE IDE.


### Removing gh-pages folder

In order to clear `gh-pages` folder, we must first remove it from disk and
instruct git to prune work trees. Command are

    rm -rf gh-pages
    git worktree prune

This will remove folder and clear git's cache. Note that this does not remove
gh-pages branch from git repository. This branch is still safely stored on
disk and on remote.
